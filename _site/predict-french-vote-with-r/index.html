<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.4.1 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Predict french vote with R - Colin FAY</title>




<meta name="description" content="Let’s try a prediction of the french presidential vote, based on the results from the first round.">




<meta name="author" content="colin_fay">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="Colin FAY">
<meta property="og:title" content="Predict french vote with R">


  <link rel="canonical" href="http://localhost:4000/predict-french-vote-with-r/">
  <meta property="og:url" content="http://localhost:4000/predict-french-vote-with-r/">



  <meta property="og:description" content="Let’s try a prediction of the french presidential vote, based on the results from the first round.">



  <meta name="twitter:site" content="@_colinfay">
  <meta name="twitter:title" content="Predict french vote with R">
  <meta name="twitter:description" content="Let’s try a prediction of the french presidential vote, based on the results from the first round.">
  <meta name="twitter:url" content="http://localhost:4000/predict-french-vote-with-r/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://raw.githubusercontent.com/ColinFay/colinfay.github.io/master/uploads/2017/08/colin_prev.png">
    
  

  
    <meta name="twitter:creator" content="@colin_fay">
  



  

  



  <meta property="og:image" content="https://raw.githubusercontent.com/ColinFay/colinfay.github.io/master/uploads/2017/08/colin_prev.png">



  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-04-28T00:00:00+02:00">






  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "http://localhost:4000",
      "logo": "https://raw.githubusercontent.com/ColinFay/colinfay.github.io/master/uploads/2017/08/colin_prev.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Colin FAY",
      "url" : "http://localhost:4000",
      "sameAs" : ["https://twitter.com/_ColinFay","https://www.linkedin.com/in/colinfay/"]
    }
  </script>






<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Colin FAY Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->

<meta http-equiv="cleartype" content="on">

<link rel="shortcut icon" type="image/x-icon" href="https://raw.githubusercontent.com/ColinFay/colinfay.github.io/master/favicon.png">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/">Colin FAY</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="https://colinfay.github.io/">Home</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://colinfay.github.io/about/">About</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://colinfay.github.io/talks-publications/">Talks & Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://colinfay.github.io/open-source/">Open Source</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://colinfay.me/categories/">Blog</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://colinfay.me/r-manuals/">R manuals</a></li>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="http://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Predict french vote with R</li>
      
    
  </ol>
</nav>
  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://avatars1.githubusercontent.com/u/17936236?v=3&s=460" alt="Colin FAY" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">Colin FAY</h3>
    
      <p class="author__bio" itemprop="description">
        Data Science & Social Media at ThinkR. Founder of Data Bzh and cofounder of the Breizh Data Club.
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Rennes</span>
        </li>
      

      

      
        <li>
          <a href="mailto:contact@colinfay.me">
            <meta itemprop="email" content="contact@colinfay.me" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      
        <li>
          <a href="https://twitter.com/_colinfay" itemprop="sameAs">
            <i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/colinfay" itemprop="sameAs">
            <i class="fa fa-fw fa-linkedin-square" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/ColinFay" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
<li>
  <a href="http://www.thinkr.fr">
    <i class="fa fa-bookmark" aria-hidden="true"></i> ThinkR
  </a>
</li>
<li>
  <a href="http://data-bzh.fr">
    <i class="fa fa-map-marker" aria-hidden="true"></i> Data-Bzh
  </a>
</li>
<li>
  <a href="http://breizhdataclub.org/">
    <i class="fa fa-tag" aria-hidden="true"></i> Breizh Data Club
  </a>
</li>
<li>
  <a href="http://www.rweekly.org">
    <i class="fa fa-rss" aria-hidden="true"></i> RWeekly
  </a>
</li>

    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Predict french vote with R">
    <meta itemprop="description" content="Let’s try a prediction of the french presidential vote, based on the results from the first round.">
    <meta itemprop="datePublished" content="April 28, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Predict french vote with R
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  2 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <h2 id="lets-try-a-prediction-of-the-french-presidential-vote-based-on-the-results-from-the-first-round">Let’s try a prediction of the french presidential vote, based on the results from the first round.</h2>
<!--more-->

<p>Before the second poll of the french election (May 7th), candidates are invited to give voting instructions to their supporters, supporting one of the candidates still in the running. Let’s try to predict the results of the second round, based on these information.</p>

<p>Disclaimer: the predictions contained in this work are purely hypothetical, and rely on very strong and unrealistic assumptions, like “voters for a candidate will follow his voting instructions”.</p>
<h3 id="creating-the-data">Creating the data</h3>
<p>I’ve extracted the info from :</p>
<ul>
  <li>“who supports who” on <a href="http://www.francetvinfo.fr/elections/presidentielle/fillon-melenchon-hamon-poutou-quelle-est-la-consigne-de-vote-des-neuf-elimines-en-vue-du-second-tour_2158950.html">France Tv</a></li>
  <li>1st round results on <a href="https://www.data.gouv.fr/fr/datasets/election-presidentielle-des-23-avril-et-7-mai-2017-resultats-du-1er-tour/">data.gouv</a></li>
</ul>

<p>Let’s create the tibble.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tibble</span><span class="p">(</span><span class="w">
  </span><span class="n">NOM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"MACRON"</span><span class="p">,</span><span class="s2">"MÉLENCHON"</span><span class="p">,</span><span class="s2">"FILLON"</span><span class="p">,</span><span class="s2">"LEPEN"</span><span class="p">,</span><span class="s2">"HAMON"</span><span class="p">,</span><span class="s2">"DUPONT-AIGNAN"</span><span class="p">,</span><span class="s2">"POUTOU"</span><span class="p">,</span><span class="s2">"LASSALLE"</span><span class="p">,</span><span class="s2">"ARTHAUD"</span><span class="p">,</span><span class="s2">"ASSELINEAU"</span><span class="p">,</span><span class="w"> </span><span class="s2">"CHEMINADE"</span><span class="p">,</span><span class="s2">"BLANC"</span><span class="p">),</span><span class="w">
  </span><span class="n">SIDE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"CENTRE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"GAUCHE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DROITE"</span><span class="p">,</span><span class="s2">"DROITE"</span><span class="p">,</span><span class="s2">"GAUCHE"</span><span class="p">,</span><span class="s2">"DROITE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"GAUCHE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"SANS ETIQUETTE"</span><span class="p">,</span><span class="s2">"GAUCHE"</span><span class="p">,</span><span class="s2">"DROITE"</span><span class="p">,</span><span class="s2">"GAUCHE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"BLANC"</span><span class="p">),</span><span class="w">
  </span><span class="n">APPEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"MACRON"</span><span class="p">,</span><span class="s2">"NSP"</span><span class="p">,</span><span class="s2">"MACRON"</span><span class="p">,</span><span class="s2">"LEPEN"</span><span class="p">,</span><span class="s2">"MACRON"</span><span class="p">,</span><span class="s2">"NSP"</span><span class="p">,</span><span class="s2">"NSP"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"NSP"</span><span class="p">,</span><span class="s2">"BLANC"</span><span class="p">,</span><span class="s2">"NSP"</span><span class="p">,</span><span class="s2">"NSP"</span><span class="p">,</span><span class="s2">"BLANC"</span><span class="p">),</span><span class="w"> 
  </span><span class="n">VOIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">8654331</span><span class="p">,</span><span class="w"> </span><span class="m">7058859</span><span class="p">,</span><span class="w"> </span><span class="m">7211121</span><span class="p">,</span><span class="m">7678558</span><span class="p">,</span><span class="w"> </span><span class="m">2291025</span><span class="p">,</span><span class="w"> </span><span class="m">1694898</span><span class="p">,</span><span class="w"> </span><span class="m">394510</span><span class="p">,</span><span class="w"> 
           </span><span class="m">435367</span><span class="p">,</span><span class="w"> </span><span class="m">232439</span><span class="p">,</span><span class="w"> </span><span class="m">332592</span><span class="p">,</span><span class="w"> </span><span class="m">65671</span><span class="p">,</span><span class="w"> </span><span class="m">655404</span><span class="p">),</span><span class="w">
  </span><span class="n">POURC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">VOIX</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">36704775</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Notes: in the APPEL column, the “NSP” factor means that the candidate didn’t give instructions to his/her supporters.</p>

<p>Let’s start by a short visualisation of the results :</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">NOM</span><span class="p">,</span><span class="w"> </span><span class="n">POURC</span><span class="p">),</span><span class="w"> </span><span class="n">POURC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#b78d6a"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Résultats du premier tour en France"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_light</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>
<p><a href="https://colinfay.github.io/wp-content/uploads/2017/04/resultats-premier-tour.png"><img class="aligncenter size-full wp-image-1673" src="https://colinfay.github.io/wp-content/uploads/2017/04/resultats-premier-tour.png" alt="Résultats du premier tour" width="1000" height="500" /></a></p>
<h3 id="simulating-second-round-results">Simulating second round results</h3>
<p>Here are the results if everyone who voted for a candidate on the first round follows the instructions give by this candidate.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">APPEL</span><span class="p">,</span><span class="w"> </span><span class="n">POURC</span><span class="p">),</span><span class="w"> </span><span class="n">POURC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#b78d6a"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Résultats simulés du second tour en France"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Suivi des consignes de vote"</span><span class="p">,</span><span class="w">
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_light</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><a href="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-1.png"><img class="aligncenter size-full wp-image-1674" src="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-1.png" alt="Simulation 1" width="1000" height="500" /></a>
Ok, now what do we do with the candidate who hasn’t give any instruction?</p>
<h4 id="lets-try-various-scenarios">Let’s try various scenarios.</h4>
<p>What would happen if the NSP equally vote for each candidate?</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span><span class="w">
</span><span class="n">sim1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">APPEL</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">VOIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">POURC</span><span class="p">))</span><span class="w">
</span><span class="n">sim1</span><span class="o">$</span><span class="n">VOIX</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">sim1</span><span class="o">$</span><span class="n">VOIX</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> 
               </span><span class="n">sim1</span><span class="o">$</span><span class="n">VOIX</span><span class="p">[[</span><span class="m">2</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sim1</span><span class="o">$</span><span class="n">VOIX</span><span class="p">[[</span><span class="m">4</span><span class="p">]]</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w">
               </span><span class="n">sim1</span><span class="o">$</span><span class="n">VOIX</span><span class="p">[[</span><span class="m">3</span><span class="p">]]</span><span class="o">+</span><span class="w"> </span><span class="n">sim1</span><span class="o">$</span><span class="n">VOIX</span><span class="p">[[</span><span class="m">4</span><span class="p">]]</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w">
               </span><span class="kc">NA</span><span class="p">)</span><span class="w">
</span><span class="n">sim1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">na.omit</span><span class="p">(</span><span class="n">sim1</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">sim1</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">APPEL</span><span class="p">,</span><span class="w"> </span><span class="n">VOIX</span><span class="p">),</span><span class="w"> </span><span class="n">VOIX</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#b78d6a"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Résultats simulés du second tour en France"</span><span class="p">,</span><span class="w">
       </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NSP à 50 / 50 Macron - Le Pen"</span><span class="p">,</span><span class="w">
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_light</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>
<p><a href="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-2.png"><img class="aligncenter size-full wp-image-1678" src="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-2.png" alt="" width="1000" height="500" /></a></p>

<p>Ok, we’re good with that one. What would happen if all the NSP vote for Marine Le Pen?</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">APPEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str_replace_all</span><span class="p">(</span><span class="n">result</span><span class="o">$</span><span class="n">APPEL</span><span class="p">,</span><span class="w"> </span><span class="s2">"NSP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"LEPEN"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">APPEL</span><span class="p">,</span><span class="w"> </span><span class="n">POURC</span><span class="p">),</span><span class="w"> </span><span class="n">POURC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#b78d6a"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Résultats simulés du second tour en France"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NSP 100% Marine Le Pen"</span><span class="p">,</span><span class="w">
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_light</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>
<p><a href="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-3.png"><img class="aligncenter size-full wp-image-1677" src="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-3.png" alt="" width="1000" height="500" /></a></p>

<p>Aaaand that’s tight, but Macron still wins. What if all NSP go to Macron?</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">APPEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str_replace_all</span><span class="p">(</span><span class="n">result</span><span class="o">$</span><span class="n">APPEL</span><span class="p">,</span><span class="w"> </span><span class="s2">"NSP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"MACRON"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">APPEL</span><span class="p">,</span><span class="w"> </span><span class="n">POURC</span><span class="p">),</span><span class="w"> </span><span class="n">POURC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#b78d6a"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Résultats simulés du second tour en France"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NSP 100% Macron"</span><span class="p">,</span><span class="w">
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_light</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>
<p><a href="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-4.png"><img class="aligncenter size-full wp-image-1676" src="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-4.png" alt="" width="1000" height="500" /></a></p>

<p>Yeah, that was obvious.</p>

<h3 id="left-vs-right-wing">Left vs Right wing</h3>
<p>OK, let’s try something else. What if all voters who chose a right wing candidate vote for Marine Le Pen, and voters for a left wing candidate Emmanuel Macron ?</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">data.frame</span><span class="p">(</span><span class="n">SIDE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"CENTRE"</span><span class="p">,</span><span class="s2">"GAUCHE"</span><span class="p">,</span><span class="s2">"DROITE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"BLANC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"SANS ETIQUETTE"</span><span class="p">),</span><span class="w"> 
                       </span><span class="n">SIM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"MACRON"</span><span class="p">,</span><span class="s2">"MACRON"</span><span class="p">,</span><span class="s2">"LEPEN"</span><span class="p">,</span><span class="w"> </span><span class="s2">"BLANC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"BLANC"</span><span class="p">)),</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"SIDE"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">SIM.y</span><span class="p">,</span><span class="w"> </span><span class="n">POURC</span><span class="p">),</span><span class="w"> </span><span class="n">POURC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#b78d6a"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Résultats simulés du second tour en France"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_light</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>
<p><a href="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-5.png"><img class="aligncenter size-full wp-image-1675" src="https://colinfay.github.io/wp-content/uploads/2017/04/simulation-second-tour-5.png" alt="" width="1000" height="500" /></a></p>

<p>Ok, still tight, but Emmanuel Macron still wins</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/categories/#r-blog-en" class="page__taxonomy-item" rel="tag">r-blog-en</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-04-28T00:00:00+02:00">April 28, 2017</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=_colinfay&text=Predict french vote with R http://localhost:4000/predict-french-vote-with-r/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/predict-french-vote-with-r/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http://localhost:4000/predict-french-vote-with-r/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/predict-french-vote-with-r/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="http://localhost:4000/rstats-api-calls-sys-sleep/" class="pagination--pager" title="#RStats — API calls et Sys.sleep
">Previous</a>
    
    
      <a href="http://localhost:4000/cartographier-second-tour-francais-r/" class="pagination--pager" title="Cartographier le second tour français avec R
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/_colinfay"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/ColinFay"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Colin FAY. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65307055-3', 'auto');
  ga('send', 'pageview');
</script>







  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'http-colinfay-me';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>
